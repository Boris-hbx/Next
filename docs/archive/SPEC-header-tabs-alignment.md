# SPEC: åè¨€æ ä¸ Tabs è¡Œå¯¹é½ + æŒ‰é’®åŠ¨æ•ˆ

## é—®é¢˜

1. æ·»åŠ "ä¾‹è¡Œ"æŒ‰é’®åï¼ŒTabs è¡Œæ€»å®½åº¦è¶…è¿‡äº†å››è±¡é™å®½åº¦ (1364px)
2. åè¨€æ ä¸ Tabs è¡Œå·¦å³è¾¹ç¼˜æœªå¯¹é½
3. "ä¾‹è¡Œ"æŒ‰é’®é¢œè‰²æ”¹ä¸ºè“è‰²ï¼ˆä¸è¦ç²‰çº¢ï¼‰
4. éœ€è¦ä»»åŠ¡çŠ¶æ€æŒ‡ç¤ºåŠ¨æ•ˆ

## å½“å‰å¸ƒå±€

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚        ã€Œåè¨€å†…å®¹...ã€        [æ¢ä¸€ä¸ª]    â”‚  â† 1364px (page-header)
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ“‹ä¾‹è¡Œ â”‚ Today â”‚ This Week â”‚ Next 30 â”‚ +æ·»åŠ   â”‚  â† è¶…å‡º 1364px
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      Q1         â”‚       Q2        â”‚  â† 1364px (å››è±¡é™)
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚      Q3         â”‚       Q4        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## æœŸæœ›å¸ƒå±€

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    ã€Œåè¨€å†…å®¹...ã€              [æ¢ä¸€ä¸ª]  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ“‹ä¾‹è¡Œ â”‚ Today â”‚ Week â”‚ Month â”‚  +æ·»åŠ    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      Q1         â”‚       Q2        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚      Q3         â”‚       Q4        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚â†â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ 1364px â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’â”‚
          ä¸‰è€…å®½åº¦ä¸€è‡´ï¼Œå·¦å³å¯¹é½
```

## å®ç°æ–¹æ¡ˆ

### 1. ç»Ÿä¸€å®½åº¦

åè¨€æ å’Œ Tabs è¡Œéƒ½ä½¿ç”¨å›ºå®šå®½åº¦ 1364pxï¼š

```css
.page-header {
    width: 1364px;
    margin: 0 auto 1rem auto;
}

.matrix-tabs {
    width: 1364px;  /* å›ºå®šå®½åº¦ */
    margin: 0 auto 1rem auto;
    box-sizing: border-box;
}
```

### 2. Tabs è¡Œå†…éƒ¨å¼¹æ€§å¸ƒå±€

è®©å†…éƒ¨å…ƒç´ è‡ªé€‚åº”ï¼Œä¸è¶…å‡ºå®¹å™¨ï¼š

```css
.matrix-tabs {
    display: flex;
    justify-content: space-between;  /* ä¸¤ç«¯å¯¹é½ */
    align-items: center;
}

.tab-actions {
    margin-left: auto;  /* æ·»åŠ ä»»åŠ¡æŒ‰é’®å³å¯¹é½ */
}
```

### 3. Tab æŒ‰é’®ç¼©å†™ï¼ˆå¦‚éœ€è¦ï¼‰

å¦‚æœç©ºé—´ä»ç„¶ç´§å¼ ï¼Œå¯ç¼©çŸ­æ ‡ç­¾æ–‡å­—ï¼š
- "This Week" â†’ "Week"
- "Next 30 Days" â†’ "Month"

---

## å®ç°æ¸…å•

| # | æ”¹åŠ¨ | æ–‡ä»¶ |
|---|------|------|
| 1 | matrix-tabs æ·»åŠ  width: 1364px å’Œå±…ä¸­ | style.css |
| 2 | è°ƒæ•´ tabs å†…éƒ¨ flex å¸ƒå±€ | style.css |
| 3 | (å¯é€‰) ç¼©çŸ­ tab æ–‡å­— | todo.html |

---

## æ–°å¢ï¼šæŒ‰é’®æ ·å¼ä¸åŠ¨æ•ˆ

### 1. "ä¾‹è¡Œ"æŒ‰é’®æ”¹ä¸ºè“è‰²

```css
.btn-routine {
    background: linear-gradient(135deg, #667eea, #764ba2);  /* è“ç´«æ¸å˜ */
}
```

### 2. ä»»åŠ¡çŠ¶æ€åŠ¨æ•ˆï¼ˆçº¿æ¡ç¯ç»•ï¼‰

å‚è€ƒåè¨€æ çš„ç¯ç»•åŠ¨æ•ˆï¼Œç»™"ä¾‹è¡Œ"å’Œ"Today"æŒ‰é’®æ·»åŠ æ—‹è½¬è¾¹æ¡†ï¼š

```
ã€æœ‰æœªå®Œæˆä»»åŠ¡ã€‘              ã€å…¨éƒ¨å®Œæˆã€‘
â”Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”               â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”Š  ä¾‹è¡Œ  â†â”€â”€â”€â”¼â”€â”€ çº¿æ¡æ—‹è½¬    â”‚   ä¾‹è¡Œ    â”‚ â† æ— åŠ¨æ•ˆ
â””â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”˜               â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

æ³¨ï¼šä¾‹è¡ŒæŒ‰é’®ä¸å¸¦å›¾æ ‡ï¼Œçº¯æ–‡å­—ã€‚

### 3. åŠ¨æ•ˆé€Ÿåº¦è§„åˆ™

| å®Œæˆåº¦ | åŠ¨æ•ˆé€Ÿåº¦ | è¯´æ˜ |
|--------|----------|------|
| 0-50%  | å¿«é€Ÿ (2s) | æé†’ç”¨æˆ·èµ¶ç´§å®Œæˆ |
| 51-99% | æ…¢é€Ÿ (6s) | å¿«å®Œæˆäº†ï¼Œæ”¾æ¾ä¸€ç‚¹ |
| 100%   | æ— åŠ¨æ•ˆ | å…¨éƒ¨å®Œæˆï¼Œå®‰é™ |

### 4. å®ç°æ–¹æ¡ˆ

#### CSS åŠ¨ç”»

```css
/* åŸºç¡€æŒ‰é’®ï¼ˆæ— åŠ¨æ•ˆï¼‰ */
.btn-routine,
.matrix-tab[data-tab="today"] {
    position: relative;
    overflow: hidden;
}

/* æœ‰ä»»åŠ¡æ—¶æ·»åŠ åŠ¨æ•ˆ class */
.btn-routine.has-pending::before,
.matrix-tab[data-tab="today"].has-pending::before {
    content: '';
    position: absolute;
    inset: 0;
    border-radius: inherit;
    padding: 2px;
    background: conic-gradient(from var(--angle), transparent 70%, #667eea 100%);
    -webkit-mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
    -webkit-mask-composite: xor;
    mask-composite: exclude;
    animation: rotate-border var(--speed, 4s) linear infinite;
}

/* å¿«é€Ÿï¼ˆå®Œæˆåº¦ä½ï¼‰ */
.btn-routine.speed-fast::before,
.matrix-tab.speed-fast::before {
    --speed: 2s;
}

/* æ…¢é€Ÿï¼ˆå®Œæˆåº¦é«˜ï¼‰ */
.btn-routine.speed-slow::before,
.matrix-tab.speed-slow::before {
    --speed: 6s;
}

@property --angle {
    syntax: '<angle>';
    initial-value: 0deg;
    inherits: false;
}

@keyframes rotate-border {
    to { --angle: 360deg; }
}
```

#### JS é€»è¾‘

```javascript
function updateButtonAnimations() {
    // ä¾‹è¡ŒæŒ‰é’®
    var routineBtn = document.querySelector('.btn-routine');
    var pendingRoutines = routines.filter(r => !r.completed_today).length;
    var totalRoutines = routines.length;

    if (totalRoutines > 0 && pendingRoutines > 0) {
        routineBtn.classList.add('has-pending');
        var completion = (totalRoutines - pendingRoutines) / totalRoutines;
        routineBtn.classList.toggle('speed-fast', completion < 0.5);
        routineBtn.classList.toggle('speed-slow', completion >= 0.5);
    } else {
        routineBtn.classList.remove('has-pending', 'speed-fast', 'speed-slow');
    }

    // Today æŒ‰é’®
    var todayBtn = document.querySelector('.matrix-tab[data-tab="today"]');
    var todayItems = allItems.filter(i => i.tab === 'today' && !i.deleted);
    var pendingToday = todayItems.filter(i => !i.completed).length;
    var totalToday = todayItems.length;

    if (totalToday > 0 && pendingToday > 0) {
        todayBtn.classList.add('has-pending');
        var completion = (totalToday - pendingToday) / totalToday;
        todayBtn.classList.toggle('speed-fast', completion < 0.5);
        todayBtn.classList.toggle('speed-slow', completion >= 0.5);
    } else {
        todayBtn.classList.remove('has-pending', 'speed-fast', 'speed-slow');
    }
}
```

---

## å®ç°æ¸…å•

| # | æ”¹åŠ¨ | æ–‡ä»¶ |
|---|------|------|
| 1 | matrix-tabs æ·»åŠ  width: 1364px å’Œå±…ä¸­ | style.css |
| 2 | è°ƒæ•´ tabs å†…éƒ¨ flex å¸ƒå±€ | style.css |
| 3 | ä¾‹è¡ŒæŒ‰é’®æ”¹ä¸ºè“è‰²æ¸å˜ | todo.html |
| 4 | æ·»åŠ  has-pending åŠ¨æ•ˆ CSS | todo.html |
| 5 | æ·»åŠ  updateButtonAnimations() å‡½æ•° | todo.html |
| 6 | åœ¨ renderItems / loadRoutines åè°ƒç”¨æ›´æ–° | todo.html |
| 7 | (å¯é€‰) ç¼©çŸ­ tab æ–‡å­— | todo.html |

---

## æ–°å¢ï¼šåå­—çº¿åŠ¨æ€å®šä½

### é—®é¢˜

å››è±¡é™æ”¹ä¸º `auto auto` é«˜åº¦è‡ªé€‚åº”åï¼Œåå­—çº¿ï¼ˆå››ç®­å¤´ï¼‰ä½ç½®å›ºå®šï¼Œæ— æ³•è·Ÿéšè±¡é™å¤§å°å˜åŒ–ã€‚

### æœŸæœ›è¡Œä¸º

```
ã€ä»»åŠ¡å°‘ã€‘                    ã€ä»»åŠ¡å¤šã€‘
â”Œâ”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”                â”Œâ”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”
â”‚ Q1  â”‚ Q2  â”‚                â”‚ Q1  â”‚ Q2  â”‚
â”‚     â”‚     â”‚                â”‚å¤šä»»åŠ¡â”‚     â”‚
â”œâ”€â”€â”¼â”€â”€â”¼â”€â”€â”¼â”€â”€â”¤ â† åå­—çº¿å±…ä¸­   â”‚     â”‚     â”‚
â”‚ Q3  â”‚ Q4  â”‚                â”œâ”€â”€â”¼â”€â”€â”¼â”€â”€â”¼â”€â”€â”¤ â† åå­—çº¿è·Ÿéš
â””â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”˜                â”‚ Q3  â”‚ Q4  â”‚
                             â””â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”˜
```

### å®ç°æ–¹æ¡ˆ

ä½¿ç”¨ JS åŠ¨æ€è®¡ç®—åå­—çº¿ä½ç½®ï¼š

```javascript
function updateCrossLines() {
    var grid = document.querySelector('.matrix-grid');
    var q1 = document.getElementById('quadrant-important-urgent');
    var q3 = document.getElementById('quadrant-not-important-urgent');

    if (!grid || !q1 || !q3) return;

    // è®¡ç®—ç¬¬ä¸€è¡Œé«˜åº¦ï¼ˆQ1/Q2ï¼‰
    var row1Height = q1.offsetHeight;
    // æ°´å¹³çº¿ Y ä½ç½® = padding + row1Height + gap/2
    var horizontalY = 32 + row1Height + 16; // padding=32px, gap=32px

    var horizontalLine = document.querySelector('.cross-line.horizontal');
    if (horizontalLine) {
        horizontalLine.style.top = horizontalY + 'px';
    }
}

// åœ¨ renderItems åè°ƒç”¨
// ç›‘å¬çª—å£ resize
```

### è§¦å‘æ—¶æœº

- é¡µé¢åŠ è½½å
- `renderItems()` æ‰§è¡Œå
- çª—å£ resize æ—¶

---

## å®ç°æ¸…å•

| # | æ”¹åŠ¨ | æ–‡ä»¶ |
|---|------|------|
| 1 | matrix-tabs æ·»åŠ  width: 1364px å’Œå±…ä¸­ | style.css |
| 2 | è°ƒæ•´ tabs å†…éƒ¨ flex å¸ƒå±€ | style.css |
| 3 | ä¾‹è¡ŒæŒ‰é’®æ”¹ä¸ºè“è‰²æ¸å˜ï¼Œå»æ‰å›¾æ ‡ | todo.html |
| 4 | æ·»åŠ  has-pending åŠ¨æ•ˆ CSS | todo.html |
| 5 | æ·»åŠ  updateButtonAnimations() å‡½æ•° | todo.html |
| 6 | æ·»åŠ  updateCrossLines() å‡½æ•° | todo.html |
| 7 | åœ¨ renderItems åè°ƒç”¨æ›´æ–°å‡½æ•° | todo.html |

## éªŒæ”¶æ ‡å‡†

1. åè¨€æ ã€Tabs è¡Œã€å››è±¡é™ä¸‰è€…å®½åº¦ä¸€è‡´ (1364px)
2. ä¸‰è€…å·¦å³è¾¹ç¼˜å¯¹é½
3. Tabs è¡Œå†…å®¹ä¸æº¢å‡º
4. "ä¾‹è¡Œ"æŒ‰é’®ä¸ºè“ç´«è‰²æ¸å˜ï¼Œçº¯æ–‡å­—æ— å›¾æ ‡
5. æœ‰æœªå®Œæˆä¾‹è¡Œä»»åŠ¡æ—¶ï¼Œ"ä¾‹è¡Œ"æŒ‰é’®æœ‰æ—‹è½¬è¾¹æ¡†
6. æœ‰æœªå®Œæˆ Today ä»»åŠ¡æ—¶ï¼Œ"Today"æŒ‰é’®æœ‰æ—‹è½¬è¾¹æ¡†
7. å®Œæˆåº¦ < 50% æ—¶è¾¹æ¡†æ—‹è½¬å¿« (2s)ï¼Œâ‰¥ 50% æ—¶æ—‹è½¬æ…¢ (6s)
8. å…¨éƒ¨å®Œæˆæ—¶åŠ¨æ•ˆæ¶ˆå¤±
9. åå­—çº¿éšè±¡é™é«˜åº¦å˜åŒ–åŠ¨æ€è°ƒæ•´ä½ç½®
