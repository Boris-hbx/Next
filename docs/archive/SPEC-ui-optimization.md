# UI 优化规范

## 概述

本规范定义了 Next 应用的三大 UI 优化需求：顶部栏改进、底部呼吸线、待办事项交互增强。

---

## 1. 顶部黑色栏优化

### 1.1 顶部栏固定显示
**需求**：滚动页面时，顶部黑色栏保持固定，不随页面滚动消失。

**实现方式**：
- 给 `.top-header` 添加 `position: fixed` 或 `position: sticky`
- 调整 `.main-content` 的 `padding-top` 以避免内容被遮挡

**验收标准**：
- [ ] 向下滚动页面时，顶部栏始终可见
- [ ] 内容不被顶部栏遮挡

---

### 1.2 移除三横线菜单按钮
**需求**：移除左侧的三横线 (☰) 按钮，因为小宠物已实现侧边栏切换功能。

**涉及元素**：
```html
<button class="header-menu-btn" id="header-menu-btn" title="菜单">
    <span class="menu-icon">☰</span>
</button>
```

**实现方式**：
- 删除上述 HTML 元素
- 删除相关的 CSS 样式和 JavaScript 事件绑定

**验收标准**：
- [ ] 顶部栏左侧不再显示三横线按钮
- [ ] 小宠物的侧边栏切换功能正常工作

---

### 1.3 移除 "Next" 标题文字
**需求**：移除顶部栏的 "Next" 文字。

**涉及元素**：
```html
<span class="header-title">Next</span>
```

**实现方式**：
- 删除上述 HTML 元素

**验收标准**：
- [ ] 顶部栏不再显示 "Next" 文字

---

### 1.4 闪电功能迁移到 B 按钮
**需求**：
- 将闪电 (⚡) 的"小球设置"功能迁移到右侧的 B 按钮
- 移除 B 按钮原有的"语录"功能
- 移除闪电图标本身

**涉及元素**：
```html
<!-- 移除这个 -->
<span class="header-logo" id="header-logo" title="点击设置小球数量">⚡</span>

<!-- 修改这个 -->
<div class="header-avatar" id="header-avatar" onclick="nextAvatarQuote()">
    <span class="avatar-text">B</span>
    <div class="avatar-quote-tooltip" id="avatar-quote-tooltip">
        <!-- 语录相关内容 -->
    </div>
</div>
```

**实现方式**：
1. 删除 `header-logo` 闪电元素
2. 将 `header-avatar` 的 `onclick` 从 `nextAvatarQuote()` 改为调用小球设置弹窗
3. 删除 `avatar-quote-tooltip` 相关 HTML
4. 删除语录相关的 JavaScript 代码 (`avatarQuotes`, `nextAvatarQuote` 等)
5. 将闪电的小球设置逻辑绑定到 B 按钮的点击事件

**验收标准**：
- [ ] 顶部栏不再显示闪电图标
- [ ] 点击 B 按钮弹出"小球设置"对话框
- [ ] B 按钮不再显示语录 tooltip
- [ ] 小球数量、感应半径等参数可正常设置和保存

---

## 2. 底部呼吸线

### 2.1 设计描述
**需求**：在页面底部添加一条细线，与顶部黑框对应，具有呼吸效果（上下起伏动画）。

**设计规格**：
- 位置：页面最底部，固定定位
- 宽度：100%
- 高度：2-4px（根据呼吸动画变化）
- 颜色：与顶部栏协调（渐变或纯色，如 `#1a1a2e` 或渐变效果）
- 动画：垂直方向上下起伏，周期约 2-3 秒

**实现方式**：
```css
.bottom-breath-line {
    position: fixed;
    bottom: 0;
    left: 0;
    right: 0;
    height: 3px;
    background: linear-gradient(90deg, #4f46e5, #7c3aed, #4f46e5);
    animation: breathe 2.5s ease-in-out infinite;
    z-index: 100;
}

@keyframes breathe {
    0%, 100% {
        transform: scaleY(1);
        opacity: 0.6;
    }
    50% {
        transform: scaleY(1.5);
        opacity: 1;
    }
}
```

**验收标准**：
- [ ] 底部显示一条细线
- [ ] 细线有呼吸效果（上下起伏/透明度变化）
- [ ] 滚动页面时细线始终固定在底部
- [ ] 视觉效果与顶部栏协调

---

## 3. 待办事项交互增强

### 3.1 事项详情弹窗
**需求**：单击待办事项时，弹出毛玻璃效果的详情窗口，显示：
- 事项详细内容
- 相关人（新增字段）
- 计划完成时间（新增字段）
- 编辑按钮

**数据模型扩展**：
```json
{
    "id": "xxx",
    "text": "任务内容",
    "tab": "today",
    "quadrant": "important-urgent",
    "tags": [],
    "assignee": "",          // 新增：相关人
    "due_date": null,        // 新增：计划完成时间
    "progress": 0,           // 新增：完成度 0-100
    "completed": false,
    "created_at": "...",
    "updated_at": "..."
}
```

**弹窗设计**：
```
┌─────────────────────────────────────┐
│  ✕                                  │  ← 关闭按钮
├─────────────────────────────────────┤
│  任务内容显示区域                     │
│  （支持多行）                         │
├─────────────────────────────────────┤
│  👤 相关人: [Boris]                  │
│  📅 计划完成: [2026-01-15]           │
│  📊 完成度: [██████░░░░] 60%         │
├─────────────────────────────────────┤
│           [编辑]                     │
└─────────────────────────────────────┘
```

**毛玻璃效果**：
```css
.task-detail-modal {
    background: rgba(255, 255, 255, 0.1);
    backdrop-filter: blur(20px);
    -webkit-backdrop-filter: blur(20px);
    border: 1px solid rgba(255, 255, 255, 0.2);
    border-radius: 16px;
}
```

**验收标准**：
- [ ] 单击待办事项弹出详情窗口
- [ ] 详情窗口有毛玻璃效果
- [ ] 显示任务内容、相关人、计划完成时间
- [ ] 编辑按钮可进入编辑模式
- [ ] 点击窗口外部或关闭按钮可关闭弹窗

---

### 3.2 完成度进度条
**需求**：将原有的"确认是否完成"弹窗改为"设置完成度"功能。

**交互流程**：
1. 点击待办事项前的矩形复选框
2. 弹出"设置完成度"弹窗
3. 显示可拖动的进度条（0% - 100%）
4. 实时显示当前百分比
5. 如果拖到 100%，显示确认提示："确定要标记为完成吗？"
6. 确认后标记任务为已完成

**弹窗设计**：
```
┌─────────────────────────────────────┐
│       设置完成度                     │
├─────────────────────────────────────┤
│                                     │
│  [████████████░░░░░░░░░░░░]  60%   │
│        ↑ 可拖动滑块                  │
│                                     │
├─────────────────────────────────────┤
│      [取消]        [确定]           │
└─────────────────────────────────────┘
```

**100% 确认提示**：
```
┌─────────────────────────────────────┐
│       确认完成                       │
├─────────────────────────────────────┤
│                                     │
│    确定要标记为完成吗？               │
│                                     │
│  完成后任务将移至已完成列表            │
│                                     │
├─────────────────────────────────────┤
│      [取消]        [确定完成]        │
└─────────────────────────────────────┘
```

**验收标准**：
- [ ] 点击复选框弹出"设置完成度"弹窗
- [ ] 进度条可通过鼠标拖动
- [ ] 实时显示当前百分比
- [ ] 拖到 100% 时弹出确认提示
- [ ] 确认后任务标记为完成
- [ ] 完成度数据正确保存到后端

---

## 4. 技术约束

### 后端修改
- 文件：`backend/app.py`
- 需要扩展 Todo 数据模型，增加 `assignee`、`due_date`、`progress` 字段
- 相关 API：`POST /api/todos`、`PUT /api/todos/<id>`

### 前端修改
- 文件：`frontend/templates/base.html`（顶部栏、底部线）
- 文件：`frontend/templates/todo.html`（待办事项交互）
- 文件：`assets/css/style.css`（可选，样式抽取）

### 数据存储
- 文件：`data/todos.json`
- 向后兼容：旧数据缺少新字段时使用默认值

---

## 5. 实施顺序建议

1. **第一阶段**：顶部栏优化（1.1 - 1.4）
2. **第二阶段**：底部呼吸线（2.1）
3. **第三阶段**：待办事项数据模型扩展（后端）
4. **第四阶段**：完成度进度条（3.2）
5. **第五阶段**：事项详情弹窗（3.1）

---

## 6. 不在范围内

- 移动端适配（本次仅针对桌面端）
- 多用户协作功能
- 任务提醒/通知功能
- 任务历史记录

---

## 审批

请确认以上规范是否符合需求，确认后开始实施。
